(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{263:function(t,e,n){},288:function(t,e,n){"use strict";n(263)},295:function(t,e,n){"use strict";n.r(e);var a={name:"InputErrorDisplay",props:["state","msgError","msgSuccess"],computed:{errorMessage(){return this.msgError?this.msgError:"Annotation required."},successMessage(){return this.msgSuccess?this.msgSuccess:"Annotation valid."}}},i=n(16),o=Object(i.a)(a,(function(){var t=this,e=t._self._c;return e("div",[t._t("default"),t._v(" "),e("b-form-invalid-feedback",{attrs:{state:t.state}},[t._v("\n    "+t._s(t.errorMessage)+"\n  ")]),t._v(" "),e("b-form-valid-feedback",{attrs:{state:t.state}},[t._v("\n    "+t._s(t.successMessage)+"\n  ")])],2)}),[],!1,null,"3d308658",null).exports,s={name:"TextInput",components:{InputErrorDisplay:o},props:["value","config","state","msgError","msgSuccess"],computed:{inputVal:{get(){return this.value},set(t){this.$emit("input",t)}}},methods:{validate:()=>!0}},r=Object(i.a)(s,(function(){var t=this,e=t._self._c;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("BInput",{attrs:{name:t.config.name,state:t.state},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1)}),[],!1,null,"feeaac20",null).exports,l={name:"TextareaInput",components:{InputErrorDisplay:o},props:["value","config","state","msgError","msgSuccess"],computed:{inputVal:{get(){return this.value},set(t){this.$emit("input",t)}}}},u=Object(i.a)(l,(function(){var t=this,e=t._self._c;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("BTextarea",{attrs:{name:t.config.name,state:t.state},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1)}),[],!1,null,"b556f86e",null).exports;n(93);function c(t,e,n="."){if(null==t||null==e||"string"!=typeof e||e.trim().length<1)return null;const a=e.trim().split(n);let i=t;for(let t in a){if(!(a[t]in i))return null;i=i[a[t]]}return i}function p(t,e){let n=[];if(Array.isArray(t))for(let a of t)if(e&&a&&"object"==typeof a&&"string"==typeof a.fromDocument){const t=a.fromDocument;let i=t in e?e[t]:c(e,t);if("string"==typeof i){const t="string"==typeof a.separator?a.separator:";";i=t?i.split(t):[i],i=i.map(t=>t.trim());const e="string"==typeof a.valueLabelSeparator?a.valueLabelSeparator:"=";e&&(i=i.map(t=>{const n=t.indexOf(e);return n>=0?{value:t.substring(0,n).trim(),label:t.substring(n+e.length).trim()}:t}))}n.push(...p(i))}else null!=a&&("string"==typeof a?n.push({value:a,text:a}):"value"in a&&n.push({value:a.value,text:"label"in a?a.label:a.value,helptext:"helptext"in a?a.helptext:null}));else for(let e in t)n.push({value:e,text:t[e]});return n}var m={name:"RadioInput",components:{InputErrorDisplay:o},props:["value","config","document","state","msgError","msgSuccess"],computed:{options(){return this.config&&this.config.options?p(this.config.options,this.document):null},inputVal:{get(){return this.value},set(t){this.$emit("input",t)}}}},d=Object(i.a)(m,(function(){var t=this,e=t._self._c;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess,"label-cols":"3"}},[e("b-form-group",{attrs:{id:t.config.name}},t._l(t.options,(function(n,a){return e("b-form-radio",{key:n.value,attrs:{value:n.value,state:t.state,inline:"vertical"!==t.config.orientation,name:t.config.name},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[t._v("\n        "+t._s(n.text)+"\n        "),null!=n.helptext?e("b-icon-question-circle",{staticClass:"annotation-help-prompt",attrs:{id:t.config.name+"__opt"+a}}):t._e(),t._v(" "),null!=n.helptext?e("b-tooltip",{attrs:{target:t.config.name+"__opt"+a,title:n.helptext}}):t._e()],1)})),1)],1)}),[],!1,null,"ccbb4eaa",null).exports,h={name:"CheckboxInput",components:{InputErrorDisplay:o},props:["value","config","document","state","msgError","msgSuccess"],computed:{options(){return this.config&&this.config.options?p(this.config.options,this.document):null},inputVal:{get(){return this.value},set(t){this.$emit("input",t)}}}},f=Object(i.a)(h,(function(){var t=this,e=t._self._c;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("b-form-checkbox-group",{attrs:{stacked:"vertical"==t.config.orientation,name:t.config.name},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},t._l(t.options,(function(n,a){return e("b-form-checkbox",{key:n.value,attrs:{value:n.value,state:t.state}},[t._v("\n      "+t._s(n.text)+"\n      "),null!=n.helptext?e("b-icon-question-circle",{staticClass:"annotation-help-prompt",attrs:{id:t.config.name+"__opt"+a}}):t._e(),t._v(" "),null!=n.helptext?e("b-tooltip",{attrs:{target:t.config.name+"__opt"+a,title:n.helptext}}):t._e()],1)})),1)],1)}),[],!1,null,"4fe134a3",null).exports,g={name:"SelectorInput",components:{InputErrorDisplay:o},props:["value","config","document","state","msgError","msgSuccess"],computed:{options(){return this.config&&this.config.options?p(this.config.options,this.document):null},inputVal:{get(){return this.value},set(t){this.$emit("input",t)}}}},v=Object(i.a)(g,(function(){var t=this,e=t._self._c;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("BFormSelect",{attrs:{options:t.options,state:t.state,name:t.config.name},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1)}),[],!1,null,"c4d709ee",null).exports,_=n(286),b=n.n(_),x={name:"HtmlDisplay",props:["config","document"],computed:{htmlDisplay(){try{if(this.config&&this.config.text){let t={};return this.document&&(t=this.document),b.a.render(this.config.text,t)}}catch(t){console.log(t)}return""}}},y=Object(i.a)(x,(function(){return(0,this._self._c)("div",{domProps:{innerHTML:this._s(this.htmlDisplay)}})}),[],!1,null,"081ebbc0",null).exports;const T={Annotation:"Annotation",Test:"Test",Training:"Training"};var E={name:"MarkdownRenderer",props:{content:{default:""},options:{default:()=>({markdownIt:{html:!0}})}}},k=Object(i.a)(E,(function(){return(0,this._self._c)("markdown-it-vue",{attrs:{content:this.content,options:this.options}})}),[],!1,null,"e0913990",null).exports,w=n(287),O=n.n(w),I={name:"AnnotationRenderer",components:{TextInput:r,TextareaInput:u,RadioInput:d,CheckboxInput:f,SelectorInput:v,HtmlDisplay:y,MarkdownRenderer:k},data:()=>({annotationOutput:{},validation:{},validationErrorMsg:{},inputTypes:{text:"TextInput",textarea:"TextareaInput",radio:"RadioInput",checkbox:"CheckboxInput",selector:"SelectorInput",html:"HtmlDisplay"},ignoreValidateTypes:["html"],startTime:null,DocumentType:T,answerBgColor:{}}),props:{config:{default:null},document:{default:()=>({text:"<p>Some html text <strong>in bold</strong>.</p><p>Paragraph 2.</p>"})},document_type:{default:null},doc_gold_field:{default:"gold"},doc_preannotation_field:{default:""},allow_document_reject:{default:null},allow_cancel:{default:null},clear_after_submit:{default:!0,type:Boolean}},computed:{preAnnotationValues(){return null!=this.document&&null!=this.doc_preannotation_field?c(this.document,this.doc_preannotation_field):null}},methods:{setAnnotationData(t){this.annotationOutput=t},startTimer(){this.startTime=new Date},getTimeElapsed(){if(this.document_type!=this.DocumentType.Annotation)return null;return(new Date-this.startTime)/1e3},inputEventHandler(t){this.$emit("input",this.annotationOutput)},getInputType(t){return t in this.inputTypes?this.inputTypes[t]:null},generateValidationTracker(t){if(t){this.validation={};for(let e of t)this.validation[e.name]=null}},validateAnnotation(){this.validation={},this.validationErrorMsg={};for(let t of this.config){const e=t.name,n=t.type;if(this.ignoreValidateTypes.includes(n)||t.optional&&("checkbox"!==n||!("minSelected"in t)))t.name in this.validation&&delete this.validation[e];else if(this.validation[e]=!1,e in this.annotationOutput&&this.valueNotEmpty(this.annotationOutput[e]))if("text"!==n&&"textarea"!==n||!("regex"in t))this.validation[e]="checkbox"!==n||!("minSelected"in t)||t.minSelected<=this.annotationOutput[e].length;else{const n=new RegExp(t.regex);this.validation[e]=n.test(this.annotationOutput[e])}}let t=!0;for(let e in this.validation)this.ignoreValidateTypes.includes(e)||this.validation[e]||(t=!1);return t},valueNotEmpty:t=>"string"==typeof t&&t.length>0||t instanceof Array&&t.length>0,submitHandler(t){let e=this.getTimeElapsed(),n=this.validateAnnotation();this.$forceUpdate(),n&&(this.$emit("submit",this.annotationOutput,e),this.clear_after_submit&&this.clearForm(),this.startTimer())},clearForm(){this.annotationOutput={},this.validation={},this.fillWithPreAnnotation()},clearFormHandler(t){this.clearForm()},rejectHandler(t){this.$emit("reject"),this.startTimer()},cancelHandler(t){this.$emit("cancel"),this.startTimer()},getAnswerBgColor(t){let e=this.annotationOutput[t.name],n=this.document[this.doc_gold_field][t.name].value;return Object.keys(t.options).includes(e)?e==n?"success":"danger":"Default"},showExplanation(t){return"html"!=t.type&&(this.document_type==T.Training&&null!==this.annotationOutput[t.name])},answerText(t){let e=this.annotationOutput[t.name],n=this.document[this.doc_gold_field][t.name].value;return null!==Object.keys(t.options)?e==n?"Correct! ✔️":"Incorrect ❌":""},fillWithPreAnnotation(){null!=this.preAnnotationValues&&this.setAnnotationData(O.a.cloneDeep(this.preAnnotationValues))}},watch:{config:{immediate:!0,handler(t){this.generateValidationTracker(t)}},document:{immediate:!0,handler(){this.fillWithPreAnnotation()}},doc_preannotation_field:{immediate:!0,handler(){this.fillWithPreAnnotation()}},annotationOutput:{immediate:!0,deep:!0,handler(){for(const t in this.config)this.showExplanation(this.config[t])&&(this.answerBgColor[this.config[t].name]=this.getAnswerBgColor(this.config[t]))}}},mounted(){for(const t in this.config)"html"!=this.config[t].type&&(this.answerBgColor[this.config[t].name]="Default");this.startTimer()}},D={name:"AnnotationRendererPreview",components:{AnnotationRenderer:Object(i.a)(I,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"annotation"},[t._l(t.config,(function(n){return e("div",{key:n.name},[e("b-form-group",{attrs:{label:n.title}},[n.description?e("p",{staticClass:"annotation-description"},[t._v(t._s(n.description))]):t._e(),t._v(" "),t.getInputType(n.type)?e(t.getInputType(n.type),{tag:"component",attrs:{name:n.name,config:n,document:t.document,state:t.validation[n.name],"msg-success":n.valSuccess,"msg-error":n.valError},on:{input:t.inputEventHandler},model:{value:t.annotationOutput[n.name],callback:function(e){t.$set(t.annotationOutput,n.name,e)},expression:"annotationOutput[elemConfig.name]"}}):e("div",[t._v("\n        Component invalid\n      ")]),t._v(" "),t.showExplanation(n)?e("b-card",{staticClass:"mb-4",attrs:{"border-variant":t.answerBgColor[n.name]}},[e("MarkdownRenderer",{attrs:{content:t.answerText(n)+"<br>"+t.document[t.doc_gold_field][n.name].explanation}})],1):t._e()],1)],1)})),t._v(" "),e("BRow",[e("b-col",[e("BButton",{staticClass:"mr-4",attrs:{variant:"success"},on:{click:function(e){return e.preventDefault(),t.submitHandler.apply(null,arguments)}}},[t._v("Submit")]),t._v(" "),e("BButton",{staticClass:"mr-4",attrs:{variant:"warning"},on:{click:function(e){return e.preventDefault(),t.clearFormHandler.apply(null,arguments)}}},[t._v("Clear")]),t._v(" "),t.allow_document_reject?e("BButton",{attrs:{variant:"danger"},on:{click:function(e){return e.preventDefault(),t.rejectHandler.apply(null,arguments)}}},[t._v("Reject document")]):t._e(),t._v(" "),t.allow_cancel?e("BButton",{attrs:{variant:"danger"},on:{click:function(e){return e.preventDefault(),t.cancelHandler.apply(null,arguments)}}},[t._v("Cancel")]):t._e()],1)],1)],2)}),[],!1,null,"94679a44",null).exports},data:()=>({annotationOutput:{}}),props:{preAnnotation:{default:()=>""},document:{default:()=>({text:"Sometext with <strong>html</strong>"})},config:{default:()=>[{name:"htmldisplay",type:"html",text:"{{{text}}}"},{name:"sentiment",type:"radio",title:"Sentiment",description:"Please select a sentiment of the text above.",options:{negative:"Negative",neutral:"Neutral",positive:"Positive"}}]}}},A=(n(288),Object(i.a)(D,(function(){var t=this,e=t._self._c;return e("div",[e("b-tabs",[e("b-tab",{attrs:{title:"Code"}},[t._t("default")],2),t._v(" "),e("b-tab",{attrs:{title:"Preview"}},[e("b-card",{staticClass:"mb-2 mt-2"},[e("AnnotationRenderer",{attrs:{config:t.config,document:t.document,allow_document_reject:!0,doc_preannotation_field:t.preAnnotation},model:{value:t.annotationOutput,callback:function(e){t.annotationOutput=e},expression:"annotationOutput"}})],1),t._v(" "),e("b-card",{staticClass:"mb-2 mt-2"},[e("p",[e("strong",[t._v("Annotation output:")])]),t._v("\n        "+t._s(t.annotationOutput)+"\n      ")])],1)],1)],1)}),[],!1,null,null,null));e.default=A.exports}}]);