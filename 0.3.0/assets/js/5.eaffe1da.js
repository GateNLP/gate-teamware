(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{363:function(t,n,e){},396:function(t,n,e){"use strict";e(363)},403:function(t,n,e){"use strict";e.r(n);var i=e(362),a=(e(393),e(89),e(194),e(195),e(340),e(54),e(341),e(112),{name:"InputErrorDisplay",props:["state","msgError","msgSuccess"],computed:{errorMessage:function(){return this.msgError?this.msgError:"Annotation required."},successMessage:function(){return this.msgSuccess?this.msgSuccess:"Annotation valid."}}}),o=e(53),r=Object(o.a)(a,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[t._t("default"),t._v(" "),e("b-form-invalid-feedback",{attrs:{state:t.state}},[t._v("\n    "+t._s(t.errorMessage)+"\n  ")]),t._v(" "),e("b-form-valid-feedback",{attrs:{state:t.state}},[t._v("\n    "+t._s(t.successMessage)+"\n  ")])],2)}),[],!1,null,"3d308658",null).exports,s={name:"TextInput",components:{InputErrorDisplay:r},props:["value","config","state","msgError","msgSuccess"],computed:{inputVal:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{validate:function(){return!0}}},u=Object(o.a)(s,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("BInput",{attrs:{name:t.config.name,state:t.state},model:{value:t.inputVal,callback:function(n){t.inputVal=n},expression:"inputVal"}})],1)}),[],!1,null,"6fd3e750",null).exports,l={name:"TextareaInput",components:{InputErrorDisplay:r},props:["value","config","state","msgError","msgSuccess"],computed:{inputVal:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},c=Object(o.a)(l,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("BTextarea",{attrs:{name:t.config.name,state:t.state},model:{value:t.inputVal,callback:function(n){t.inputVal=n},expression:"inputVal"}})],1)}),[],!1,null,"b283bc9e",null).exports,p=e(51),m=e(152);e(111),e(337),e(83),e(338),e(187);function f(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(null==t||null==n||"string"!=typeof n||n.trim().length<1)return null;var i=n.trim().split(e),a=t;for(var o in i){if(!(i[o]in a))return null;a=a[i[o]]}return a}function d(t,n){var e=[];if(Array.isArray(t)){var a,o=Object(i.a)(t);try{for(o.s();!(a=o.n()).done;){var r=a.value;if(n&&r&&"object"===Object(m.a)(r)&&"string"==typeof r.fromDocument){var s=r.fromDocument,u=s in n?n[s]:f(n,s);"string"==typeof u&&function(){var t="string"==typeof r.separator?r.separator:";";u=(u=t?u.split(t):[u]).map((function(t){return t.trim()}));var n="string"==typeof r.valueLabelSeparator?r.valueLabelSeparator:"=";n&&(u=u.map((function(t){var e=t.indexOf(n);return e>=0?{value:t.substring(0,e).trim(),label:t.substring(e+n.length).trim()}:t})))}(),e.push.apply(e,Object(p.a)(d(u)))}else null!=r&&("string"==typeof r?e.push({value:r,text:r}):"value"in r&&e.push({value:r.value,text:"label"in r?r.label:r.value}))}}catch(t){o.e(t)}finally{o.f()}}else for(var l in t)e.push({value:l,text:t[l]});return e}var h={name:"RadioInput",components:{InputErrorDisplay:r},props:["value","config","document","state","msgError","msgSuccess"],computed:{options:function(){return this.config&&this.config.options?d(this.config.options,this.document):null},inputVal:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},g=Object(o.a)(h,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("b-form-radio-group",{attrs:{name:t.config.name,options:t.options,state:t.state,stacked:"vertical"===t.config.orientation},model:{value:t.inputVal,callback:function(n){t.inputVal=n},expression:"inputVal"}})],1)}),[],!1,null,"347ba7fc",null).exports,v={name:"CheckboxInput",components:{InputErrorDisplay:r},props:["value","config","document","state","msgError","msgSuccess"],computed:{options:function(){return this.config&&this.config.options?d(this.config.options,this.document):null},inputVal:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},_=Object(o.a)(v,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("b-form-checkbox-group",{attrs:{name:t.config.name,options:t.options,state:t.state,stacked:"vertical"===t.config.orientation},model:{value:t.inputVal,callback:function(n){t.inputVal=n},expression:"inputVal"}})],1)}),[],!1,null,"fb3dcb78",null).exports,b={name:"SelectorInput",components:{InputErrorDisplay:r},props:["value","config","document","state","msgError","msgSuccess"],computed:{options:function(){return this.config&&this.config.options?d(this.config.options,this.document):null},inputVal:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},y=Object(o.a)(b,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("InputErrorDisplay",{attrs:{state:t.state,"msg-error":t.msgError,"msg-success":t.msgSuccess}},[e("BFormSelect",{attrs:{options:t.options,state:t.state,name:t.config.name},model:{value:t.inputVal,callback:function(n){t.inputVal=n},expression:"inputVal"}})],1)}),[],!1,null,"026b991e",null).exports,x=e(394),E={name:"HtmlDisplay",props:["config","document"],computed:{htmlDisplay:function(){try{if(this.config&&this.config.text){var t={};return this.document&&(t=this.document),x.render(this.config.text,t)}}catch(t){console.log(t)}return""}}},O=Object(o.a)(E,(function(){var t=this.$createElement;return(this._self._c||t)("div",{domProps:{innerHTML:this._s(this.htmlDisplay)}})}),[],!1,null,"55e0ebc2",null).exports,T={Annotation:"Annotation",Test:"Test",Training:"Training"},w={name:"MarkdownRenderer",props:{content:{default:""},options:{default:function(){return{markdownIt:{html:!0}}}}}},k=Object(o.a)(w,(function(){var t=this.$createElement;return(this._self._c||t)("markdown-it-vue",{attrs:{content:this.content,options:this.options}})}),[],!1,null,"e0913990",null).exports,I=e(395),D=e.n(I),A={name:"AnnotationRenderer",components:{TextInput:u,TextareaInput:c,RadioInput:g,CheckboxInput:_,SelectorInput:y,HtmlDisplay:O,MarkdownRenderer:k},data:function(){return{annotationOutput:{},validation:{},validationErrorMsg:{},inputTypes:{text:"TextInput",textarea:"TextareaInput",radio:"RadioInput",checkbox:"CheckboxInput",selector:"SelectorInput",html:"HtmlDisplay"},ignoreValidateTypes:["html"],startTime:null,DocumentType:T,answerBgColor:{}}},props:{config:{default:null},document:{default:function(){return{text:"<p>Some html text <strong>in bold</strong>.</p><p>Paragraph 2.</p>"}}},document_type:{default:null},doc_gold_field:{default:"gold"},doc_preannotation_field:{default:""},allow_document_reject:{default:null},allow_cancel:{default:null},clear_after_submit:{default:!0,type:Boolean}},computed:{preAnnotationValues:function(){return null!=this.document&&null!=this.doc_preannotation_field?f(this.document,this.doc_preannotation_field):null}},methods:{setAnnotationData:function(t){this.annotationOutput=t},startTimer:function(){this.startTime=new Date},getTimeElapsed:function(){return this.document_type!=this.DocumentType.Annotation?null:(new Date-this.startTime)/1e3},inputEventHandler:function(t){this.$emit("input",this.annotationOutput)},getInputType:function(t){return t in this.inputTypes?this.inputTypes[t]:null},generateValidationTracker:function(t){if(t){this.validation={};var n,e=Object(i.a)(t);try{for(e.s();!(n=e.n()).done;){var a=n.value;this.validation[a.name]=null}}catch(t){e.e(t)}finally{e.f()}}},validateAnnotation:function(){this.validation={},this.validationErrorMsg={};var t,n=Object(i.a)(this.config);try{for(n.s();!(t=n.n()).done;){var e=t.value,a=e.name,o=e.type;if(this.ignoreValidateTypes.includes(o)||e.optional&&("checkbox"!==o||!("minSelected"in e)))e.name in this.validation&&delete this.validation[a];else if(this.validation[a]=!1,a in this.annotationOutput&&this.valueNotEmpty(this.annotationOutput[a]))if("text"!==o&&"textarea"!==o||!("regex"in e))this.validation[a]="checkbox"!==o||!("minSelected"in e)||e.minSelected<=this.annotationOutput[a].length;else{var r=new RegExp(e.regex);this.validation[a]=r.test(this.annotationOutput[a])}}}catch(t){n.e(t)}finally{n.f()}var s=!0;for(var u in this.validation)this.ignoreValidateTypes.includes(u)||this.validation[u]||(s=!1);return s},valueNotEmpty:function(t){return"string"==typeof t&&t.length>0||t instanceof Array&&t.length>0},submitHandler:function(t){var n=this.getTimeElapsed(),e=this.validateAnnotation();this.$forceUpdate(),e&&(this.$emit("submit",this.annotationOutput,n),this.clear_after_submit&&this.clearForm(),this.startTimer())},clearForm:function(){this.annotationOutput={},this.validation={},this.fillWithPreAnnotation()},clearFormHandler:function(t){this.clearForm()},rejectHandler:function(t){this.$emit("reject"),this.startTimer()},cancelHandler:function(t){this.$emit("cancel"),this.startTimer()},getAnswerBgColor:function(t){var n=this.annotationOutput[t.name],e=this.document[this.doc_gold_field][t.name].value;return Object.keys(t.options).includes(n)?n==e?"success":"danger":"Default"},showExplanation:function(t){return"html"!=t.type&&!(this.document_type!=T.Training||!Object.keys(t.options).includes(this.annotationOutput[t.name]))},answerText:function(t){var n=this.annotationOutput[t.name],e=this.document[this.doc_gold_field][t.name].value;return Object.keys(t.options).includes(n)?n==e?"Correct! ✔️":"Incorrect ❌":""},fillWithPreAnnotation:function(){null!=this.preAnnotationValues&&this.setAnnotationData(D.a.cloneDeep(this.preAnnotationValues))}},watch:{config:{immediate:!0,handler:function(t){this.generateValidationTracker(t)}},document:{immediate:!0,handler:function(){this.fillWithPreAnnotation()}},doc_preannotation_field:{immediate:!0,handler:function(){this.fillWithPreAnnotation()}},annotationOutput:{immediate:!0,deep:!0,handler:function(){for(var t in this.config)this.showExplanation(this.config[t])&&(this.answerBgColor[this.config[t].name]=this.getAnswerBgColor(this.config[t]))}}},mounted:function(){for(var t in this.config)"html"!=this.config[t].type&&(this.answerBgColor[this.config[t].name]="Default");this.startTimer()}},V={name:"AnnotationRendererPreview",components:{AnnotationRenderer:Object(o.a)(A,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"annotation"},[t._l(t.config,(function(n){return e("div",{key:n.name},[e("b-form-group",{attrs:{label:n.title}},[n.description?e("p",{staticClass:"annotation-description"},[t._v(t._s(n.description))]):t._e(),t._v(" "),t.getInputType(n.type)?e(t.getInputType(n.type),{tag:"component",attrs:{name:n.name,config:n,document:t.document,state:t.validation[n.name],"msg-success":n.valSuccess,"msg-error":n.valError},on:{input:t.inputEventHandler},model:{value:t.annotationOutput[n.name],callback:function(e){t.$set(t.annotationOutput,n.name,e)},expression:"annotationOutput[elemConfig.name]"}}):e("div",[t._v("\n        Component invalid\n      ")]),t._v(" "),t.showExplanation(n)?e("b-card",{staticClass:"mb-4",attrs:{"border-variant":t.answerBgColor[n.name]}},[e("MarkdownRenderer",{attrs:{content:t.answerText(n)+"<br>"+t.document[t.doc_gold_field][n.name].explanation}})],1):t._e()],1)],1)})),t._v(" "),e("b-row",[e("b-col",[e("BButton",{staticClass:"mr-4",attrs:{variant:"success"},on:{click:function(n){return n.preventDefault(),t.submitHandler.apply(null,arguments)}}},[t._v("Submit")]),t._v(" "),e("BButton",{staticClass:"mr-4",attrs:{variant:"warning"},on:{click:function(n){return n.preventDefault(),t.clearFormHandler.apply(null,arguments)}}},[t._v("Clear")]),t._v(" "),t.allow_document_reject?e("BButton",{attrs:{variant:"danger"},on:{click:function(n){return n.preventDefault(),t.rejectHandler.apply(null,arguments)}}},[t._v("Reject document")]):t._e(),t._v(" "),t.allow_cancel?e("BButton",{attrs:{variant:"danger"},on:{click:function(n){return n.preventDefault(),t.cancelHandler.apply(null,arguments)}}},[t._v("Cancel")]):t._e()],1)],1)],2)}),[],!1,null,"2cb020b2",null).exports},data:function(){return{annotationOutput:{}}},props:{preAnnotation:{default:function(){return""}},document:{default:function(){return{text:"Sometext with <strong>html</strong>"}}},config:{default:function(){return[{name:"htmldisplay",type:"html",text:"{{{text}}}"},{name:"sentiment",type:"radio",title:"Sentiment",description:"Please select a sentiment of the text above.",options:{negative:"Negative",neutral:"Neutral",positive:"Positive"}}]}}}},S=(e(396),Object(o.a)(V,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("b-tabs",[e("b-tab",{attrs:{title:"Code"}},[t._t("default")],2),t._v(" "),e("b-tab",{attrs:{title:"Preview"}},[e("b-card",{staticClass:"mb-2 mt-2"},[e("AnnotationRenderer",{attrs:{config:t.config,document:t.document,allow_document_reject:!0,doc_preannotation_field:t.preAnnotation},model:{value:t.annotationOutput,callback:function(n){t.annotationOutput=n},expression:"annotationOutput"}})],1),t._v(" "),e("b-card",{staticClass:"mb-2 mt-2"},[e("p",[e("strong",[t._v("Annotation output:")])]),t._v("\n        "+t._s(t.annotationOutput)+"\n      ")])],1)],1)],1)}),[],!1,null,null,null));n.default=S.exports}}]);