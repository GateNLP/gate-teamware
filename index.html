<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GATE Teamware | GATE Teamware Documentation</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Documentation for GATE Teamware">
    
    <link rel="preload" href="/gate-teamware/assets/css/0.styles.7a366795.css" as="style"><link rel="preload" href="/gate-teamware/assets/js/app.b791c032.js" as="script"><link rel="preload" href="/gate-teamware/assets/js/2.d026e46e.js" as="script"><link rel="preload" href="/gate-teamware/assets/js/9.861c7d30.js" as="script"><link rel="prefetch" href="/gate-teamware/assets/js/10.f5f58fb4.js"><link rel="prefetch" href="/gate-teamware/assets/js/11.5323823d.js"><link rel="prefetch" href="/gate-teamware/assets/js/12.1a1fb7cd.js"><link rel="prefetch" href="/gate-teamware/assets/js/13.90005e8e.js"><link rel="prefetch" href="/gate-teamware/assets/js/14.105e8da6.js"><link rel="prefetch" href="/gate-teamware/assets/js/15.41de8073.js"><link rel="prefetch" href="/gate-teamware/assets/js/16.d6a76b23.js"><link rel="prefetch" href="/gate-teamware/assets/js/3.8a1a6d53.js"><link rel="prefetch" href="/gate-teamware/assets/js/4.8d101a9b.js"><link rel="prefetch" href="/gate-teamware/assets/js/5.e9d2a4b0.js"><link rel="prefetch" href="/gate-teamware/assets/js/6.42d99655.js"><link rel="prefetch" href="/gate-teamware/assets/js/7.a3571617.js"><link rel="prefetch" href="/gate-teamware/assets/js/8.1f6ed009.js">
    <link rel="stylesheet" href="/gate-teamware/assets/css/0.styles.7a366795.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/gate-teamware/" aria-current="page" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">GATE Teamware Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/gate-teamware/" aria-current="page" class="active sidebar-link">GATE Teamware</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/gate-teamware/#django-settings-files" class="sidebar-link">Django settings files</a></li><li class="sidebar-sub-header"><a href="/gate-teamware/#installation-for-development" class="sidebar-link">Installation for development</a></li><li class="sidebar-sub-header"><a href="/gate-teamware/#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/gate-teamware/#updating-packages" class="sidebar-link">Updating packages</a></li><li class="sidebar-sub-header"><a href="/gate-teamware/#development-server" class="sidebar-link">Development server</a></li><li class="sidebar-sub-header"><a href="/gate-teamware/#testing" class="sidebar-link">Testing</a></li><li class="sidebar-sub-header"><a href="/gate-teamware/#deployment-pipeline" class="sidebar-link">Deployment Pipeline</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>User guide</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gate-teamware"><a href="#gate-teamware" class="header-anchor">#</a> GATE Teamware</h1> <p>A web application for collaborative document annotation.</p> <h2 id="django-settings-files"><a href="#django-settings-files" class="header-anchor">#</a> Django settings files</h2> <p>Django settings are located in <code>annotation_tool/setttings</code> folder. The app will use <code>base.py</code> setting by default
and this must be overridden depending on use.</p> <h3 id="secret-py"><a href="#secret-py" class="header-anchor">#</a> secret.py</h3> <p>A <code>secret.py</code> should be created to hold settings that should not be made public by tracking through version
control. A <code>secret_default.py</code> exists as a guide and to provide default value for testing.</p> <h2 id="installation-for-development"><a href="#installation-for-development" class="header-anchor">#</a> Installation for development</h2> <p>The service depends on a combination of python and js libraries. <code>conda</code> is recommended as it's able to install
python libraries and nodejs which is used to install js libraries.</p> <ul><li>Install anaconda/miniconda</li> <li>Create a blank virtual conda env<div class="language-bash extra-class"><pre class="language-bash"><code>$ conda create -n annotation <span class="token assign-left variable">python</span><span class="token operator">=</span><span class="token number">3.9</span>
</code></pre></div></li> <li>Activate conda environment<div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token builtin class-name">source</span> activate annotation
<span class="token comment"># or</span>
$ conda activate annotation
</code></pre></div></li> <li>Install python dependencies in conda environment using pip</li></ul> <div class="language- extra-class"><pre class="language-text"><code>(annotation)$ pip install -r requirements.txt -r requirements-dev.txt
</code></pre></div><ul><li>Install nodejs, postgresql and openssl in the conda environment</li></ul> <div class="language- extra-class"><pre class="language-text"><code>(annotation)$ conda install -y -c anaconda postgresql
(annotation)$ conda install -y -c conda-forge nodejs=14.*
</code></pre></div><ul><li>Install nodejs dependencies<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>annotation<span class="token punctuation">)</span>$ <span class="token function">npm</span> <span class="token function">install</span>
</code></pre></div></li></ul> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <h3 id="database"><a href="#database" class="header-anchor">#</a> Database</h3> <h3 id="sending-e-mail"><a href="#sending-e-mail" class="header-anchor">#</a> Sending E-mail</h3> <p>It's recommended to specify e-mail configurations inside the <code>secrets.py</code> settings file. As these settings will
include username and passwords that should not be tracked by version control.</p> <h4 id="e-mail-using-smtp"><a href="#e-mail-using-smtp" class="header-anchor">#</a> E-mail using SMTP</h4> <p>SMTP is supported as standard in Django, add the following configurations with your own details
to the <code>secret.py</code> settings file:</p> <div class="language-python extra-class"><pre class="language-python"><code>EMAIL_BACKEND <span class="token operator">=</span> <span class="token string">'django.core.mail.backends.smtp.EmailBackend'</span>
EMAIL_HOST <span class="token operator">=</span> <span class="token string">'myserver.com'</span>
EMAIL_PORT <span class="token operator">=</span> <span class="token number">22</span>
EMAIL_HOST_USER <span class="token operator">=</span> <span class="token string">'username'</span>
EMAIL_HOST_PASSWORD <span class="token operator">=</span> <span class="token string">'password'</span>
</code></pre></div><h4 id="e-mail-using-google-api"><a href="#e-mail-using-google-api" class="header-anchor">#</a> E-mail using Google API</h4> <p>The <a href="https://github.com/dolfim/django-gmailapi-backend" target="_blank" rel="noopener noreferrer">django-gmailapi-backend<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> library
has been added to allow sending of mail through Google's API as sending through SMTP is disabled as standard.</p> <p>Unlike with SMTP, Google's API requires OAuth authentication which means a project and a credential has to be
created through Google's cloud console.</p> <ul><li>More information on the Gmail API: <a href="https://developers.google.com/gmail/api/guides/sending" target="_blank" rel="noopener noreferrer">https://developers.google.com/gmail/api/guides/sending<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>OAuth credentials for sending emails: <a href="https://github.com/google/gmail-oauth2-tools/wiki/OAuth2DotPyRunThrough" target="_blank" rel="noopener noreferrer">https://github.com/google/gmail-oauth2-tools/wiki/OAuth2DotPyRunThrough<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>This package includes the script linked in the documentation above, which simplifies the setup of the API credentials. The following outlines the key steps:</p> <ol><li>Create a project in the Google developer console, <a href="https://console.cloud.google.com/" target="_blank" rel="noopener noreferrer">https://console.cloud.google.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Enable the Gmail API</li> <li>Create OAuth 2.0 credentials, you'll likely want to create a <code>Desktop</code></li> <li>Create a valid refresh_token using the helper script included in the package:</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>gmail_oauth2 --generate_oauth2_token <span class="token punctuation">\</span>
  --client_id<span class="token operator">=</span><span class="token string">&quot;&lt;client_id&gt;&quot;</span> <span class="token punctuation">\</span>
  --client_secret<span class="token operator">=</span><span class="token string">&quot;&lt;client_secret&gt;&quot;</span> <span class="token punctuation">\</span>
  --scope<span class="token operator">=</span><span class="token string">&quot;https://www.googleapis.com/auth/gmail.send&quot;</span>
</code></pre></div><ol><li>Add the created credentials and tokens to the <code>secret.py</code> as shown below:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>EMAIL_BACKEND = 'gmailapi_backend.mail.GmailBackend'
GMAIL_API_CLIENT_ID = 'google_assigned_id'
GMAIL_API_CLIENT_SECRET = 'google_assigned_secret'
GMAIL_API_REFRESH_TOKEN = 'google_assigned_token'
</code></pre></div><h2 id="updating-packages"><a href="#updating-packages" class="header-anchor">#</a> Updating packages</h2> <p>To update packages after a merge, run the following commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Activate the conda environment</span>
<span class="token builtin class-name">source</span> activate annotation-tool
<span class="token comment"># Update any packages changed in the environnment.yml</span>
conda <span class="token function">env</span> update -f environment.yml
<span class="token comment"># Update any packages changed in package.json</span>
<span class="token function">npm</span> <span class="token function">install</span>
</code></pre></div><h2 id="development-server"><a href="#development-server" class="header-anchor">#</a> Development server</h2> <p>The application uses django's dev server to serve page contents and run the RPC API, it also uses Vue CLI's
development server to serve dynamic assets such as javascript or stylesheets allowing for hot-reloading
during development.</p> <p>To run both servers together:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run serve
</code></pre></div><p>To run separately:</p> <ul><li>Django server<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run serve:backend
</code></pre></div></li> <li>Vue CLI dev server<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run serve:frontend
</code></pre></div></li></ul> <h2 id="testing"><a href="#testing" class="header-anchor">#</a> Testing</h2> <p>All the tests can be run using the following command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run <span class="token builtin class-name">test</span>
</code></pre></div><h3 id="backend-testing"><a href="#backend-testing" class="header-anchor">#</a> Backend Testing</h3> <p>Pytest is used for testing the backend.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run test:backend
</code></pre></div><h4 id="backend-test-files"><a href="#backend-test-files" class="header-anchor">#</a> Backend test files</h4> <ul><li>Unit test files are located in <code>/backend/tests</code></li></ul> <h3 id="frontend-testing"><a href="#frontend-testing" class="header-anchor">#</a> Frontend testing</h3> <p><a href="https://jestjs.io/" target="_blank" rel="noopener noreferrer">Jest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is used for frontend testing.
The <a href="https://testing-library.com/docs/vue-testing-library/intro/" target="_blank" rel="noopener noreferrer">Vue testing-library<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is used for testing
Vue components.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run test:frontend
</code></pre></div><h4 id="frontend-test-files"><a href="#frontend-test-files" class="header-anchor">#</a> Frontend test files</h4> <ul><li>Frontend test files are located in <code>/fontend/tests/unit</code> and should the extension <code>.spec.js</code></li></ul> <h4 id="testing-js-functions"><a href="#testing-js-functions" class="header-anchor">#</a> Testing JS functions</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;Description of a group of tests to be run&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>

    <span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">//The code here is run before each test</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;A single test's description&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>

        <span class="token comment">// Assertions are done with the expect() function e.g.</span>
        <span class="token keyword">let</span> funcOutput <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">+</span> <span class="token number">10</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>funcOutput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>
      

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="mocking-js-classes"><a href="#mocking-js-classes" class="header-anchor">#</a> Mocking JS classes</h4> <p>This is an example of a mock harness for the JRPCClient class.</p> <p>A mock file is created inside a <code>__mock__</code> directory placed next to the file that's being mocked, e.g.
for our JRPCClient class at <code>/frontend/src/jrpc/index.js</code>, the mock file is <code>/frontend/src/jrpc/__mock__/index.js</code>.</p> <p>Inside the mock file <code>/frontend/src/jrpc/__mock__/index.js</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Mocking jrpc/index.js</span>
<span class="token comment">//Mocking the JRPCClient class</span>
<span class="token comment">//Replacing the call function with a custom mockCall function</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> mockCall <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>call<span class="token operator">:</span> mockCall<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> mock<span class="token punctuation">;</span>
</code></pre></div><p>Inside the test file <code>*.spec.js</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> JRPCClient <span class="token keyword">from</span> <span class="token string">&quot;@/jrpc&quot;</span><span class="token punctuation">;</span>
jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'@/jrpc'</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'@/store'</span>
<span class="token comment">//Example on how to mock the jrpc call</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;Vuex functions testing&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>

    <span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>

        <span class="token comment">//Re-implement custom mock call implementation if needed</span>
        JRPCClient<span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token number">50</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;testfunc&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>

        <span class="token keyword">const</span> noutput <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;testnormal&quot;</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>noutput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world&quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">const</span> aoutput <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;testasync&quot;</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>aoutput<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world&quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">const</span> rpc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JRPCClient</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">rpc</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;some param&quot;</span><span class="token punctuation">)</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="testing-vue-components"><a href="#testing-vue-components" class="header-anchor">#</a> Testing Vue components</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//Example of how a component could be tested</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> render<span class="token punctuation">,</span> fireEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@testing-library/vue'</span>


<span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">'@/components/HelloWorld.vue'</span>

<span class="token comment">//Testing a component e.g. HelloWorld</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'HelloWorld.vue'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders props.msg when passed'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'new message'</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> getByText <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>HelloWorld<span class="token punctuation">)</span>

    <span class="token function">getByText</span><span class="token punctuation">(</span><span class="token string">&quot;Installed CLI Plugins&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="integration-testing"><a href="#integration-testing" class="header-anchor">#</a> Integration testing</h3> <p><a href="https://www.cypress.io/" target="_blank" rel="noopener noreferrer">Cypress<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is used for integration testing.</p> <p>The integration settings are located at <code>annotation_tool/settings/integration.py</code></p> <p>To run the integration test:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run test:integration
</code></pre></div><p>The test can also be run in <strong>interactive mode</strong> using:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run serve:cypressintegration
</code></pre></div><h4 id="integration-test-files"><a href="#integration-test-files" class="header-anchor">#</a> Integration test files</h4> <p>Files related to integration testing are located in <code>/cypress</code></p> <ul><li>Test files are located in the <code>/cypress/integration</code> directory and should have the extension <code>.spec.js</code>.</li></ul> <h4 id="re-seeding-the-database"><a href="#re-seeding-the-database" class="header-anchor">#</a> Re-seeding the database</h4> <p>The command <code>npm run migrate:integration</code> resets the database and performs migration, use with <code>beforeEach</code> to run it
before every test case in a suite:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Example test suite'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Resets the database every time before</span>
        <span class="token comment">// the test is run</span>
        cy<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'npm run migrate:integration'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'Test case 1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Test something</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'Test case 2'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Test something</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="deployment-pipeline"><a href="#deployment-pipeline" class="header-anchor">#</a> Deployment Pipeline</h2> <p>Deployment is via docker-compose, using nginx to serve static content.</p> <p>A deployment script is provided to launch the docker-compose stack with the correct environment variables.</p> <p>To create the environment variables run <code>./generate-env.sh</code> to create a <code>.env</code> file containing randomly generated secrets which are mounted as envrionment variables into the container.</p> <p>Then build the images via:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>./build-images.sh
</code></pre></div><p>then deploy the stack with</p> <div class="language-bash extra-class"><pre class="language-bash"><code>./deploy.sh production <span class="token comment"># (or prod) to deploy with production settings</span>
./deploy.sh staging <span class="token comment"># (or stag) to deploy with staging settings</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/gate-teamware/userguide/quickstart.html">
        Annotators Quickstart
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/gate-teamware/assets/js/app.b791c032.js" defer></script><script src="/gate-teamware/assets/js/2.d026e46e.js" defer></script><script src="/gate-teamware/assets/js/9.861c7d30.js" defer></script>
  </body>
</html>
